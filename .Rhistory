tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(
mutate,
groupname_col = case_when(effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")
) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Varaible",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(
mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")
) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Varaible",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(
mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")
) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(
mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")
) %>%
gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get$table_body
get$table_body %>% tibble::glimpse
get$table_body %>% tibble::glimpse()
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header()
get$table_body
get$table_body %>% tibble::glimpse()
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
# gtsummary::modify_table_body(mutate,
# groupname_col = case_when(effect == "fixed" ~ "FIXED EFFECTS",
# effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
fit <- c("logLik", "AIC", "BIC")
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
# gtsummary::modify_column_unhide(column = effect) %>%
# gtsummary::add_variable_group_header(header = "FIXED EFFECTS",
#                                      variables = (effect == "fixed")) #%>%
# gtsummary::add_variable_group_header(header = "RANDOM EFFECTS",
#                                      variables =  -fix_var) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p")
get
get$table_body %>% tibble::glimpse()
get$table_body
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p") %>%
gtsummary::add_glance_table(include = all_of(fit))
get
?add_glance_table
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(#effect == "fixed" ~ "FIXED EFFECTS",
effect == "ran_pars" ~ "RANDOM EFFECTS")) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p") %>%
gtsummary::modify_table_body(~.x |> dplyr::arrange(row_type == "glance_statistic"))
get
get$table_body
get$table_body %>% tibble::glimpse()
get$table_body
get$table_body$row_type
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "ran_pars" ~ "RANDOM EFFECTS",
row_type %in% c("label", "level") ~ "FIXED EFFECTS",
row_type == "glance_statistic" ~ "MODEL FIT")) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "FIXED EFFECTS",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p") %>%
gtsummary::modify_table_body(~.x |> dplyr::arrange(row_type == "glance_statistic"))
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "ran_pars" ~ "RANDOM EFFECTS",
row_type %in% c("label", "level") ~ "FIXED EFFECTS",
row_type == "glance_statistic" ~ "MODEL FIT")) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p") %>%
gtsummary::modify_table_body(~.x |> dplyr::arrange(row_type == "glance_statistic"))
get
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "ran_pars" ~ "RANDOM EFFECTS",
row_type %in% c("label", "level") ~ "FIXED EFFECTS",
row_type == "glance_statistic" ~ "MODEL FIT")) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p") %>%
gtsummary::modify_table_body(~.x %>%  dplyr::arrange(row_type == "glance_statistic"))
get
table <- get %>%
gtsummary::as_flex_table() %>%
apaSupp::theme_apa(caption      = caption,
main_note    = main_note,
p_note       = p_note,
d            = d,
breaks       = breaks,
symbols      = symbols) %>%
flextable::align( part = "all",   j = 2, align = "right") %>%
flextable::align( part = "all",   j = 3, align = "left") %>%
flextable::align( part = "footer",       align = "left")
table
get$table_body
?gtsummary::865*2
865*2
?gtsummary::as_flex_table
get$table_body
flextable::as_flextable(x)
flextable::as_flextable(get)
get
table <- get %>%
gtsummary::as_flex_table() %>%
apaSupp::theme_apa(caption      = caption,
main_note    = main_note,
p_note       = p_note,
d            = d,
breaks       = breaks,
symbols      = symbols) %>%
flextable::align( part = "all",   j = 2, align = "right") %>%
flextable::align( part = "all",   j = 3, align = "left") %>%
flextable::align( part = "footer",       align = "left")
table
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
gtsummary::modify_table_body(mutate,
groupname_col = case_when(effect == "ran_pars" ~ "RANDOM",
row_type %in% c("label", "level") ~ "FIXED",
row_type == "glance_statistic" ~ "FIT")) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p") %>%
gtsummary::modify_table_body(~.x %>%  dplyr::arrange(row_type == "glance_statistic"))
table <- get %>%
gtsummary::as_flex_table() %>%
apaSupp::theme_apa(caption      = caption,
main_note    = main_note,
p_note       = p_note,
d            = d,
breaks       = breaks,
symbols      = symbols) %>%
flextable::align( part = "all",   j = 2, align = "right") %>%
flextable::align( part = "all",   j = 3, align = "left") %>%
flextable::align( part = "footer",       align = "left")
table
get$table_body
get$table_body %>% tibble::glimpse()
get$table_body$coefficients_label
get$table_body$coefficients_label
get$table_body$group
get <- x %>%
gtsummary::tbl_regression(intercept = TRUE,
conf.int = ci,
pvalue_fun = function(x) apaSupp::p_num(x, d = d + 1),
tidy_fun = function(x, ...) broom.mixed::tidy(x, scales = c("vcov", "sdcor"), ...),
show_single_row = show_single_row) %>%
gtsummary::add_glance_table(include = all_of(fit)) %>%
gtsummary::modify_column_unhide(column = std.error)   %>%
# gtsummary::modify_table_body(mutate,
#                              groupname_col = case_when(effect == "ran_pars" ~ "RANDOM",
#                                                        coefficients_label == "Beta" ~ "FIXED",
#                                                        row_type == "glance_statistic" ~ "FIT")) %>%
gtsummary::remove_footnote_header() %>%
gtsummary::remove_abbreviation("SE = Standard Error")  %>%
gtsummary::modify_fmt_fun(std.error ~ gtsummary::label_style_number(digits = d, prefix = "(", suffix = ")")) %>%
gtsummary::modify_header(label     = "Variable",
estimate  = "Est",
std.error = "(SE)",
p.value   = "p") %>%
gtsummary::modify_table_body(~.x %>%  dplyr::arrange(row_type == "glance_statistic"))
table <- get %>%
gtsummary::as_flex_table() %>%
apaSupp::theme_apa(caption      = caption,
main_note    = main_note,
p_note       = p_note,
d            = d,
breaks       = breaks,
symbols      = symbols) %>%
flextable::align( part = "all",   j = 2, align = "right") %>%
flextable::align( part = "all",   j = 3, align = "left") %>%
flextable::align( part = "footer",       align = "left")
table
