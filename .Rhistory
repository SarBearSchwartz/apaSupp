general_note = "Head and tail of a dataset from: McNeil, D. R. (1977) Interactive Data Analysis. Wiley.",
p_note = NULL)
tab_desc(cars)
cars %>%
dplyr::rename("Speed, mph" = speed,
"Stopping Distance, ft" = dist) %>%
tab_desc(caption = "Speed and Stopping Distances of Cars in the 1920's",
general_note = "McNeil, D. R. (1977) Interactive Data Analysis. Wiley.")
apaTab(head(cars),
caption = "Test",
p_note = NULL)
library(naniar)
cars %>%
psych::headTail() %>%
tibble::rownames_to_column(var = "ID") %>%
dplyr::rename("Speed, mph" = speed,
"Stopping Distance, ft" = dist) %>%
apaTab(caption = "Speed and Stopping Distances of Cars in the 1920's",
general_note = "Head and tail of a dataset from: McNeil, D. R. (1977) Interactive Data Analysis. Wiley.",
p_note = NULL)
tab_desc(cars)
#' Basic Descriptive Summary: n, M (SD), [Min, Max], Median with flextable
#'
#' @param df a data frame with relevant variables selected
#' @param caption the `flextable` caption for the table
#' @param general_note general note for footer of APA table
#' @param p_note significance note for APA table
#' @param fontname name of font for table
#' @param align alignment
#' @param valign vertial alignment
#' @param digits digits after the decimal place for numeric values
#' @param space line spacing in the body of the table, default is single
#' @param ... extra arguments
#'
#' @return a `flextable` table with caption
#' @import tidyverse
#' @import flextable
#' @import officer
#' @import naniar
#' @export
#'
#' @examples
#' library(tidyverse)
#'
#' tab_desc(cars)
#'
#' cars %>%
#' dplyr::rename("Speed, mph" = speed,
#'               "Stopping Distance, ft" = dist) %>%
#' tab_desc(caption = "Speed and Stopping Distances of Cars in the 1920's",
#'          general_note = "McNeil, D. R. (1977) Interactive Data Analysis. Wiley.")
#'
#'
tab_desc <- function(df,
caption = "Descriptive Summary",
general_note = NULL,
p_note = NULL,
fontname = "Times New Roman",
align = "center",
valign = "center",
digits = 2,
space = 1,
...){
n <- nrow(df)
if (is.null(general_note)){
general_note <- glue::glue("N = {n}.")
} else {
general_note <- glue::glue("{general_note} N = {n}.")
}
x <- df %>%
dplyr::summarise(across(
.cols = is.numeric,
.fns = list(valid = ~ n(),
nmiss = ~ naniar::n_miss(.x),
M = ~ mean(.x, na.rm = TRUE),
SD = ~ sd(.x, na.rm = TRUE),
min = ~ min(.x, na.rm = TRUE),
q1 = ~ quantile(.x, p = .25, na.rm = TRUE),
Mdn = ~ median(.x, na.rm = TRUE),
q3 = ~ quantile(.x, p = .75, na.rm = TRUE),
max = ~ max(.x, na.rm = TRUE)),
.names = "{col}__{fn}"
)) %>%
tidyr::pivot_longer(cols = everything(),
names_to = c("var", ".value"),
names_pattern = "(.*)__(.*)") %>%
dplyr::mutate(miss = glue::glue("{nmiss}/{valid}")) %>%
dplyr::mutate_if(is.numeric, apa2) %>%
dplyr::mutate(M_SD = glue::glue("{M} ({SD})")) %>%
dplyr::mutate(min_max = glue::glue("{min} - {max}")) %>%
dplyr::mutate(qs = glue::glue("[{q1}, {q3}]")) %>%
dplyr::mutate(nmiss = as.integer(as.numeric(nmiss))) %>%
dplyr::select("Measure" = var,
"Missing" = nmiss,
"M (SD)" = M_SD,
"Median" = Mdn,
"[Min, Max]" = min_max,
"Quantiles" = qs) %>%
apaTab(caption = caption,
general_note = general_note,
p_note = p_note,
fontname = fontname,
align = align,
valign = valign,
digits = digits,
space = space,
...) %>%
flextable::align(j = 1,
align = "left") %>%
flextable::fit_to_width(max_width = 6)
return(x)
}
tab_desc(cars)
cars %>%
dplyr::rename("Speed, mph" = speed,
"Stopping Distance, ft" = dist) %>%
tab_desc(caption = "Speed and Stopping Distances of Cars in the 1920's",
general_note = "McNeil, D. R. (1977) Interactive Data Analysis. Wiley.")
cars
fit_lm <-lm(dist ~ speed,
data = cars)
apa_Tab(fit_lm)
apaTab(fit_lm)
flextable::as_flextable(fit_lm)
?unique
source("C:/Users/A00315273/GitHub/apaSupp/R/tab_xalpha.R", echo=TRUE)
tab_xalpha <- function(df_long,
id = id,
scale_label = "scale",
caption = "Descriptive Summary",
general_note = NULL,
p_note = NULL,
fontname = "Times New Roman",
align = "center",
valign = "center",
digits = 2,
space = 1,){
tab_xalpha <- function(df_long,
id = id,
scale_label = "scale",
caption = "Descriptive Summary",
general_note = NULL,
p_note = NULL,
fontname = "Times New Roman",
align = "center",
valign = "center",
digits = 2,
space = 1,){
source("C:/Users/A00315273/GitHub/apaSupp/R/tab_xalpha.R", echo=TRUE)
border.thick <- list("width" = 2.5, color = "black", style = "solid")
border.thin <- list("width" = 1, color = "black", style = "solid")
source("C:/Users/A00315273/GitHub/apaSupp/R/tab_xalpha.R", echo=TRUE)
source("C:/Users/A00315273/GitHub/apaSupp/R/tab_xalpha.R", echo=TRUE)
source("C:/Users/A00315273/GitHub/apaSupp/R/theme_apa.R", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("C:/Users/A00315273/GitHub/apaSupp/R/spicy_histo.R", echo=TRUE)
source("C:/Users/A00315273/GitHub/apaSupp/R/spicy_histo.R", echo=TRUE)
devtools::install_github("SarBearSchwartz/apaSupp")
library(apaSupp)
library(tidyverse)
library(readxl)
library(haven)
library(furniture)
library(psych)
library(rempsyc)
library(flextable)
library(naniar)
library(rstatix)
library(ggpubr)
library(MOTE)
library(flextable)
library(texreg)
library(afex)
library(emmeans)
library(interactions)
library(performance)
library(MASS)
options(dplyr.summarise.inform = FALSE)
flextable::set_flextable_defaults(theme_fun = "theme_apa",
font.size = 10,
layout = "autofit")
ggplot2::theme_set(theme_bw())
data("Boston", package = "MASS")
df_use <- Boston %>%
tibble::rowid_to_column(var = "id") %>%
dplyr::mutate(chas = factor(chas) %>%
forcats::fct_recode("Yes"  = "1",
"No" = "0"))
df_use %>%
dplyr::select("ID" = id,
"On River" = chas,
"Low SES" = lstat,
"Home Value" = medv) %>%
psych::headTail(top = 6) %>%
flextable::flextable() %>%
apaSupp::theme_apa(caption = "Dataset View")
df_use %>%
dplyr::select("Home Value, Mdn $1000s" = medv,
"Low SES, %" = lstat) %>%
apaSupp::tab_desc(caption = "Descriptive Summary of Main Measures")
fit1 <- lm(medv ~ lstat,
data= df_use)
apaSupp::tab_lm(fit1,
var_labels = c("lstat" = "Low SES, %"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, Linear (M1)")
fit2 <- lm(medv ~ lstat + I(lstat^2),
data = df_use)
apaSupp::tab_lm(fit2,
var_labels = c("lstat" = "Low SES, Linear",
"I(lstat^2)" = "Low SES, Quadratic"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, Quadratic (M2)") %>%
flextable::width(j = 1, width = 1.5)
fit3 <- lm(medv ~ lstat*chas + I(lstat^2)*chas,
data = df_use)
apaSupp::tab_lm(fit3,
var_labels = c("chas" = "Border River",
"lstat" = "Low SES, Linear",
"I(lstat^2)" = "Low SES, Quadratic",
"lstat * chas" = "River X SES, Linear",
"chas * I(lstat^2)" = "River x SES, Quadratic"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, Quadratic, Moderated by Proximity to the Charles River (M3)") %>%
flextable::width(j = 1, width = 1.5)
apaSupp::tab_lms(list(fit1, fit2, fit3),
mod_names = c("M1", "M2", "M3"),
var_labels = c("chas" = "Border River",
"lstat" = "Low SES, Linear",
"I(lstat^2)" = "Low SES, Quadratic",
"lstat * chas" = "River X SES, Linear",
"chas * I(lstat^2)" = "River x SES, Quadratic"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, with and without Moderation by Proximity to the Charles River") %>%
flextable::width(j = 1, width = 1.25)
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
caption = "Compare 3 Model's Fit with Sevral Criteria")
?apaSupp::tab_lm_fits
devtools::install_github("SarBearSchwartz/apaSupp")
devtools::install_github("SarBearSchwartz/apaSupp", force=TRUE)
devtools::install_github("SarBearSchwartz/apaSupp", force = TRUE)
library(apaSupp)
library(tidyverse)
library(readxl)
library(haven)
library(furniture)
library(psych)
library(rempsyc)
library(flextable)
library(naniar)
library(rstatix)
library(ggpubr)
library(MOTE)
library(flextable)
library(texreg)
library(afex)
library(emmeans)
library(interactions)
library(performance)
library(MASS)
knitr::opts_chunk$set(comment     = "",
echo        = TRUE,
warning     = FALSE,
message     = FALSE,
ft.align    ="left",
fig.pos     = "hb",
fig.align   = "left",
fig.width   = 5,
fig.height  = 3)
library(apaSupp)
library(tidyverse)
library(readxl)
library(haven)
library(furniture)
library(psych)
library(rempsyc)
library(flextable)
library(naniar)
library(rstatix)
library(ggpubr)
library(MOTE)
library(flextable)
library(texreg)
library(afex)
library(emmeans)
library(interactions)
library(performance)
library(MASS)
options(dplyr.summarise.inform = FALSE)
flextable::set_flextable_defaults(theme_fun = "theme_apa",
font.size = 10,
layout = "autofit")
ggplot2::theme_set(theme_bw())
data("Boston", package = "MASS")
tibble::glimpse(Boston)
df_use <- Boston %>%
tibble::rowid_to_column(var = "id") %>%
dplyr::mutate(chas = factor(chas) %>%
forcats::fct_recode("Yes"  = "1",
"No" = "0"))
tibble::glimpse(df_use)
df_use %>%
dplyr::select("ID" = id,
"On River" = chas,
"Low SES" = lstat,
"Home Value" = medv) %>%
psych::headTail(top = 6) %>%
flextable::flextable() %>%
apaSupp::theme_apa(caption = "Dataset View")
nrow(df_use)
df_use %>%
dplyr::select("Home Value, Mdn $1000s" = medv,
"Low SES, %" = lstat) %>%
apaSupp::tab_desc(caption = "Descriptive Summary of Main Measures")
df_use %>%
furniture::table1("Home Value, Mdn $1000s" = medv,
"Low SES, %" = lstat,
splitby =  ~ chas,
total = TRUE,
test = TRUE,
na.rm = FALSE,
output = "markdown",
digits = 2,
caption = "Descriptive Summary by on Bounds of the Charles River")
df_use %>%
ggplot(aes(x = lstat,
y = medv)) +
geom_point() +
theme_bw() +
scale_x_continuous(breaks = seq(from = 0, to = 100, by = 5),
labels = scales::percent_format(scale = 1)) +
theme(legend.position = c(1, 1),
legend.justification = c(1.1, 1.1),
legend.key.width = unit(1.5, "cm"),
legend.background = element_rect(color = "black")) +
labs(x = "Lower Status of the Population",
y = "Median Value of Owner-Occupied Homes, $1000s",
color    = "Model: ",
linetype = "Model: ")
df_use %>%
ggplot(aes(x = lstat,
y = medv)) +
geom_point() +
theme_bw() +
geom_smooth(aes(color    = "Loess",
linetype = "Loess"),
se = FALSE) +
geom_smooth(aes(color    = "Linear",
linetype = "Linear"),
method = "lm",
formula = y ~ x,
se = FALSE) +
geom_smooth(aes(color    = "Quadratic",
linetype = "Quadratic"),
method = "lm",
formula = y ~ poly(x, 2),
se = FALSE) +
scale_x_continuous(breaks = seq(from = 0, to = 100, by = 5),
labels = scales::percent_format(scale = 1)) +
theme(legend.position = c(1, 1),
legend.justification = c(1.1, 1.1),
legend.key.width = unit(1.5, "cm"),
legend.background = element_rect(color = "black")) +
labs(x = "Lower Status of the Population",
y = "Median Value of Owner-Occupied Homes, $1000s",
color    = "Model: ",
linetype = "Model: ")
df_use %>%
ggplot(aes(x = lstat,
y = medv)) +
geom_point() +
theme_bw() +
geom_smooth(method = "lm",
formula = y ~ poly(x, 2),
se = FALSE) +
theme(legend.position = c(1, 1),
legend.justification = c(1.1, 1.1),
legend.key.width = unit(1.5, "cm"),
legend.background = element_rect(color = "black")) +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
labs(x = "Lower Status of the Population",
y = "Median Value of Owner-Occupied Homes, $1000s",
color    = "Model: ",
linetype = "Model: ")  +
facet_grid(~ chas)
fit1 <- lm(medv ~ lstat,
data= df_use)
apaSupp::tab_lm(fit1,
var_labels = c("lstat" = "Low SES, %"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, Linear (M1)")
effects::Effect(mod = fit1,
focal.predictors = c("lstat"),
xlevels = list(lstat = seq(from = 1, to = 35, by = .1))) %>%
data.frame() %>%
ggplot(aes(x = lstat,
y = fit)) +
geom_ribbon(aes(ymin = fit - se,
ymax = fit + se),
alpha = .2) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(from = 0, to = 100, by = 5),
labels = scales::percent_format(scale = 1)) +
labs(x = "Proportion of the Population with Low SES",
y = "Estimated Marginal Mean\n of Median Value of Owner-Occupied Homes, $1000s")
par(mfrow = c(1, 2))
plot(fit1, which = 1:2)
par(mfrow = c(1, 1))
fit2 <- lm(medv ~ lstat + I(lstat^2),
data = df_use)
anova(fit1, fit2)
apaSupp::tab_lm(fit2,
var_labels = c("lstat" = "Low SES, Linear",
"I(lstat^2)" = "Low SES, Quadratic"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, Quadratic (M2)") %>%
flextable::width(j = 1, width = 1.5)
effects::Effect(mod = fit2,
focal.predictors = c("lstat"),
xlevels = list(lstat = seq(from = 1, to = 35, by = .1))) %>%
data.frame() %>%
ggplot(aes(x = lstat,
y = fit)) +
geom_ribbon(aes(ymin = fit - se,
ymax = fit + se),
alpha = .2) +
geom_line() +
theme_bw() +
scale_x_continuous(breaks = seq(from = 0, to = 100, by = 5),
labels = scales::percent_format(scale = 1)) +
labs(x = "Proportion of the Population with Low SES",
y = "Estimated Marginal Mean\n of Median Value of Owner-Occupied Homes, $1000s")
par(mfrow = c(1, 2))
plot(fit2, which = 1:2)
par(mfrow = c(1, 1))
fit3 <- lm(medv ~ lstat*chas + I(lstat^2)*chas,
data = df_use)
anova(fit2, fit3)
apaSupp::tab_lm(fit3,
var_labels = c("chas" = "Border River",
"lstat" = "Low SES, Linear",
"I(lstat^2)" = "Low SES, Quadratic",
"lstat * chas" = "River X SES, Linear",
"chas * I(lstat^2)" = "River x SES, Quadratic"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, Quadratic, Moderated by Proximity to the Charles River (M3)") %>%
flextable::width(j = 1, width = 1.5)
effects::Effect(mod = fit3,
focal.predictors = c("lstat", "chas"),
xlevels = list(lstat = seq(from = 2, to = 35, by = .1))) %>%
data.frame() %>%
ggplot(aes(x = lstat,
y = fit,
group = chas)) +
geom_ribbon(aes(ymin = fit - se,
ymax = fit + se,
fill = chas),
alpha = .2) +
geom_line(aes(color = chas,
linetype = chas)) +
theme_bw() +
scale_x_continuous(breaks = seq(from = 0, to = 100, by = 5),
labels = scales::percent_format(scale = 1)) +
scale_linetype_manual(values = c("solid", "longdash")) +
labs(x = "Proportion of the Population with Low SES",
y = "Estimated Marginal Mean\n of Median Value of Owner-Occupied Homes, $1000s")
par(mfrow = c(1, 2))
plot(fit3, which = 1:2)
par(mfrow = c(1, 1))
apaSupp::tab_lms(list(fit1, fit2, fit3),
mod_names = c("M1", "M2", "M3"),
var_labels = c("chas" = "Border River",
"lstat" = "Low SES, Linear",
"I(lstat^2)" = "Low SES, Quadratic",
"lstat * chas" = "River X SES, Linear",
"chas * I(lstat^2)" = "River x SES, Quadratic"),
caption = "Parameter Estimates for the Median Value of Owner-Occupid Homes Regressed on Proportion of the Population with Low SES, with and without Moderation by Proximity to the Charles River") %>%
flextable::width(j = 1, width = 1.25)
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
caption = "Compare 3 Model's Fit with Sevral Criteria")
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
sort = c("AIC"),
caption = "Compare 3 Model's Fit with Sevral Criteria")
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
sort = c("AIC", "BIC"),
caption = "Compare 3 Model's Fit with Sevral Criteria")
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
sort = c("AIC", "BIC"),
caption = "Compare 3 Model's Fit with Sevral Criteria")
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
sort = c("AIC"),
caption = "Compare 3 Model's Fit with Sevral Criteria")
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
sort = "AIC",
caption = "Compare 3 Model's Fit with Sevral Criteria")
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
caption = "Compare 3 Model's Fit with Sevral Criteria")
apaSupp::tab_lm_fits(list("M1" = fit1,
"M2" = fit2,
"M3" = fit3),
sort = "AIC",
caption = "Compare 3 Model's Fit with Sevral Criteria")
